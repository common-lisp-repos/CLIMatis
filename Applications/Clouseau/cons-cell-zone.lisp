(in-package #:clouseau)

(defclass cons-cell-zone (clim3-graphics:monochrome)
  ()
  (:default-initargs :hsprawl (clim3-sprawl:sprawl 55 65 65)
		     :vsprawl (clim3-sprawl:sprawl 35 45 45)))

(defmethod clim3-paint:new-paint ((zone cons-cell-zone))
  (let ((zone-width (clim3-zone:width zone))
	(zone-height (clim3-zone:height zone))
	(color (clim3-graphics:color zone)))
    (clim3-port:with-area (0 0 40 2)
      (clim3-port:new-paint-opaque color))
    (clim3-port:with-area (0 18 40 2)
      (clim3-port:new-paint-opaque color))
    (clim3-port:with-area (0 0 2 20)
      (clim3-port:new-paint-opaque color))
    (clim3-port:with-area (38 0 2 20)
      (clim3-port:new-paint-opaque color))
    (clim3-port:with-area (19 0 2 20)
      (clim3-port:new-paint-opaque color))
    (clim3-port:with-area (9 10 2 (- zone-height 10))
      (clim3-port:new-paint-opaque color))
    (clim3-port:with-area (30 9 (- zone-width 10) 2)
      (clim3-port:new-paint-opaque color))
    (clim3-port:with-area (7 (- zone-height 10) 6 10)
      (clim3-port:new-paint-trapezoids
       '((00d0 10d0 00d0 03d0 06d0 03d0))
       (clim3-graphics:color zone)))
    (clim3-port:with-area ((- zone-width 10) 7 10 6)
      (clim3-port:new-paint-trapezoids
       '((00d0 03d0 00d0 00d0 00d0 10d0)
	 (03d0 06d0 00d0 00d0 10d0 00d0))
       (clim3-graphics:color zone)))))


(defun cons-cell (color)
  (make-instance 'cons-cell-zone :color color))
